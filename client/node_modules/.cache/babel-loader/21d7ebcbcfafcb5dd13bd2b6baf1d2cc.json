{"ast":null,"code":"var _jsxFileName = \"/home/eric/Project/Exam/happy-tube/client/src/components/views/UploadVideoPage/UploadVideoPage.js\";\nimport React, { useState, useEffect } from 'react';\nimport { Form, message, Input, Icon } from 'antd';\nimport Dropzone from 'react-dropzone';\nimport axios from 'axios';\nimport { userSelector, useSelector } from \"react-redux\";\nimport { duration } from 'moment';\nimport { TextField, Typography, Container, Grid, Paper, Select, MenuItem, FormControl, InputLabel, Button } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { CloudUpload } from '@material-ui/icons';\nconst useStyles = makeStyles(theme => ({\n  root: {\n    '& .MuiTextField-root': {\n      margin: theme.spacing(1),\n      width: '25ch',\n      flexGrow: 1\n    },\n    paper: {\n      padding: theme.spacing(2),\n      textAlign: 'center',\n      color: theme.palette.text.secondary\n    },\n    formControl: {\n      margin: theme.spacing(1),\n      minWidth: 120\n    }\n  }\n}));\nconst Private = [{\n  value: 0,\n  label: 'Private'\n}, {\n  value: 1,\n  label: 'Public'\n}];\nconst Category = [{\n  value: 0,\n  label: \"Film & Animation\"\n}, {\n  value: 0,\n  label: \"Autos & Vehicles\"\n}, {\n  value: 0,\n  label: \"Music\"\n}, {\n  value: 0,\n  label: \"Pets & Animals\"\n}, {\n  value: 0,\n  label: \"Sports\"\n}];\n\nfunction UploadVideoPage() {\n  const user = useSelector(state => state.user);\n  const [title, setTitle] = useState(\"\");\n  const [Description, setDescription] = useState(\"\");\n  const [privacy, setPrivacy] = useState(0);\n  const [Categories, setCategories] = useState(\"Film & Animation\");\n  const [FilePath, setFilePath] = useState(\"\");\n  const [Duration, setDuration] = useState(\"\");\n  const [Thumbnail, setThumbnail] = useState(\"\");\n\n  const handleChangeTitle = event => {\n    console.log(event.currentTarget.value);\n    setTitle(event.currentTarget.value);\n  };\n\n  const handleChangeDecsription = event => {\n    console.log(event.currentTarget.value);\n    setDescription(event.currentTarget.value);\n  };\n\n  const handleChangeOne = event => {\n    console.log(event.currentTarget.value);\n    setPrivacy(event.currentTarget.value);\n  };\n\n  const handleChangeTwo = event => {\n    console.log(event.currentTarget.value);\n    setCategories(event.currentTarget.value);\n  };\n\n  const onSubmit = event => {\n    event.preventDefault();\n\n    if (user.userData && !user.userData.isAuth) {\n      return alert('Please Login First');\n    }\n\n    if (title === \"\" || Description === \"\" || Categories === \"\" || FilePath === \"\" || Duration === \"\" || Thumbnail === \"\") {\n      return alert('Please fill all of the fields');\n    }\n\n    const variables = {\n      writer: user.userData._id,\n      title: title,\n      description: Description,\n      privacy: privacy,\n      filePath: FilePath,\n      category: Categories,\n      duration: Duration,\n      thumbnail: Thumbnail\n    };\n    axios.post('/api/video/uploadVideo', variables).then(response => {\n      if (response.data.success) {\n        alert('video uploaded successfully');\n      } else {\n        alert('Failed to upload video');\n      }\n    });\n  };\n\n  const onDrop = files => {\n    let formData = new FormData();\n    const config = {\n      header: {\n        'content-type': 'multipart/form-data'\n      }\n    };\n    console.log(files);\n    formData.append(\"file\", files[0]);\n    axios.post('/api/video/uploadfiles', formData, config).then(response => {\n      if (response.data.success) {\n        let variable = {\n          filePath: response.data.filePath,\n          fileName: response.data.fileName\n        };\n        setFilePath(response.data.filePath); // generate thumbnail\n\n        axios.post('/api/video/thumbnail', variable).then(response => {\n          if (response.data.success) {\n            setDuration(response.data.fileDuration);\n            setThumbnail(response.data.thumbsFilePath);\n          } else {\n            alert('Failed to make the thumbnails');\n          }\n        });\n      } else {\n        alert('failed to save the video in server');\n      }\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(Container, {\n    maxWidth: \"sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      maxWidth: '700px',\n      margin: '2rem auto'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      textAlign: 'center',\n      marginBottom: '2rem'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    style: {\n      fontSize: '50px'\n    },\n    level: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 13\n    }\n  }, \" Upload Video\")), /*#__PURE__*/React.createElement(\"hr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Form, {\n    className: useStyles().root,\n    onSubmit: onSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'space-between'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Dropzone, {\n    onDrop: onDrop,\n    multiple: false,\n    maxSize: 800000000,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }\n  }, ({\n    getRootProps,\n    getInputProps\n  }) => /*#__PURE__*/React.createElement(\"div\", Object.assign({\n    style: {\n      width: '300px',\n      height: '240px',\n      border: '1px solid lightgray',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center'\n    }\n  }, getRootProps(), {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 37\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", Object.assign({}, getInputProps(), {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 41\n    }\n  })), /*#__PURE__*/React.createElement(Icon, {\n    type: \"plus\",\n    style: {\n      fontSize: '3rem'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 41\n    }\n  }))), /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Paper, {\n    className: useStyles().paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 25\n    }\n  })), Thumbnail !== \"\" && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: `http://localhost:5000/${Thumbnail}`,\n    alt: \"haha\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 37\n    }\n  })))), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    label: \"Title\",\n    onChange: handleChangeTitle,\n    value: title,\n    variant: \"outlined\",\n    style: {\n      width: '40rem'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    multiline: true,\n    label: \"Description\",\n    onChange: handleChangeDecsription,\n    value: Description,\n    variant: \"outlined\",\n    style: {\n      width: '40rem'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 10,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 6,\n    sm: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(FormControl, {\n    className: useStyles().formControl,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(InputLabel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 21\n    }\n  }, \"Privacy\"), /*#__PURE__*/React.createElement(Select, {\n    style: {\n      width: '10rem'\n    },\n    value: Private.values[0],\n    onChange: handleChangeOne,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 21\n    }\n  }, Private.map((item, index) => /*#__PURE__*/React.createElement(\"option\", {\n    key: index,\n    value: item.value,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 33\n    }\n  }, item.label))))), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 6,\n    sm: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(FormControl, {\n    className: useStyles().formControl,\n    style: {\n      marginLeft: '1rem'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(InputLabel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 21\n    }\n  }, \"Categories\"), /*#__PURE__*/React.createElement(Select, {\n    style: {\n      width: '10rem'\n    },\n    value: Private.values[0],\n    onChange: handleChangeTwo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 21\n    }\n  }, Category.map((item, index) => /*#__PURE__*/React.createElement(\"option\", {\n    key: index,\n    value: item.label,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 33\n    }\n  }, item.label))))), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 6,\n    sm: 3,\n    style: {\n      marginLeft: '2rem'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    color: \"default\",\n    startIcon: /*#__PURE__*/React.createElement(CloudUpload, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 36\n      }\n    }),\n    onClick: onSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 25\n    }\n  }, \"Upload\"))))));\n}\n\nexport default UploadVideoPage;","map":{"version":3,"sources":["/home/eric/Project/Exam/happy-tube/client/src/components/views/UploadVideoPage/UploadVideoPage.js"],"names":["React","useState","useEffect","Form","message","Input","Icon","Dropzone","axios","userSelector","useSelector","duration","TextField","Typography","Container","Grid","Paper","Select","MenuItem","FormControl","InputLabel","Button","makeStyles","CloudUpload","useStyles","theme","root","margin","spacing","width","flexGrow","paper","padding","textAlign","color","palette","text","secondary","formControl","minWidth","Private","value","label","Category","UploadVideoPage","user","state","title","setTitle","Description","setDescription","privacy","setPrivacy","Categories","setCategories","FilePath","setFilePath","Duration","setDuration","Thumbnail","setThumbnail","handleChangeTitle","event","console","log","currentTarget","handleChangeDecsription","handleChangeOne","handleChangeTwo","onSubmit","preventDefault","userData","isAuth","alert","variables","writer","_id","description","filePath","category","thumbnail","post","then","response","data","success","onDrop","files","formData","FormData","config","header","append","variable","fileName","fileDuration","thumbsFilePath","maxWidth","marginBottom","fontSize","display","justifyContent","getRootProps","getInputProps","height","border","alignItems","values","map","item","index","marginLeft"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\nimport {  Form, message, Input, Icon } from 'antd'\nimport Dropzone from 'react-dropzone'\nimport axios from 'axios'\nimport { userSelector, useSelector } from \"react-redux\"\nimport { duration } from 'moment'\nimport { TextField, Typography, Container, Grid, Paper, Select, MenuItem, FormControl, InputLabel, Button } from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { CloudUpload } from '@material-ui/icons'\n\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n      '& .MuiTextField-root': {\n        margin: theme.spacing(1),\n        width: '25ch',\n        flexGrow: 1,\n      },\n      paper: {\n          padding: theme.spacing(2),\n          textAlign: 'center',\n          color: theme.palette.text.secondary,\n      },\n      formControl: {\n          margin: theme.spacing(1),\n          minWidth: 120,\n      }\n    },\n  }));\n\n\n\nconst Private = [\n    {value:0, label:'Private'},\n    {value:1, label:'Public'}\n]\n\nconst Category = [\n    {value:0, label: \"Film & Animation\"},\n    {value:0, label: \"Autos & Vehicles\"},\n    {value:0, label: \"Music\"},\n    {value:0, label: \"Pets & Animals\"},\n    {value:0, label: \"Sports\"},\n]\n\nfunction UploadVideoPage(){\n    const user = useSelector(state => state.user)\n\n    const [title, setTitle] = useState(\"\")\n    const [Description, setDescription] = useState(\"\")\n    const [privacy, setPrivacy] = useState(0)\n    const [Categories, setCategories] = useState(\"Film & Animation\")\n    const [FilePath, setFilePath] = useState(\"\")\n    const [Duration, setDuration] = useState(\"\")\n    const [Thumbnail, setThumbnail] = useState(\"\")\n\n    const handleChangeTitle = (event) => {\n        console.log(event.currentTarget.value)\n        setTitle(event.currentTarget.value)\n    }\n\n    const handleChangeDecsription = (event) => {\n        console.log(event.currentTarget.value)\n        setDescription(event.currentTarget.value)\n    }\n\n    const handleChangeOne = (event) => {\n        console.log(event.currentTarget.value)\n        setPrivacy(event.currentTarget.value)\n    }\n\n    const handleChangeTwo = (event) => {\n        console.log(event.currentTarget.value)\n        setCategories(event.currentTarget.value)\n    }\n\n    const onSubmit = (event) => {\n        event.preventDefault();\n\n        if(user.userData && !user.userData.isAuth){\n            return alert('Please Login First')\n        }\n\n        if(title === \"\" || Description === \"\" || Categories === \"\" || FilePath === \"\" || Duration === \"\" || Thumbnail === \"\" ){\n            return alert('Please fill all of the fields')\n        }\n\n        const variables = {\n            writer: user.userData._id,\n            title: title,\n            description: Description,\n            privacy: privacy,\n            filePath: FilePath,\n            category: Categories,\n            duration: Duration,\n            thumbnail: Thumbnail\n        }\n\n        axios.post('/api/video/uploadVideo', variables)\n            .then(response => {\n                if(response.data.success){\n                    alert('video uploaded successfully')\n\n                }else{\n                    alert('Failed to upload video')\n                }\n            })\n\n    }\n\n    const onDrop = (files) => {\n        let formData = new FormData();\n        const config = {\n            header: {'content-type': 'multipart/form-data'}\n        }\n        console.log(files)\n        formData.append(\"file\",files[0])\n\n        axios.post('/api/video/uploadfiles', formData, config)\n            .then(response =>{\n                if(response.data.success){\n\n                    let variable = {\n                        filePath: response.data.filePath,\n                        fileName: response.data.fileName\n                    }\n\n                    setFilePath(response.data.filePath)\n\n                    // generate thumbnail\n\n                    axios.post('/api/video/thumbnail',variable)\n                        .then(response => {\n                            if(response.data.success){\n                                setDuration(response.data.fileDuration)\n                                setThumbnail(response.data.thumbsFilePath)\n\n                            }else{\n                                alert('Failed to make the thumbnails')\n                            }\n                        })\n\n                }else{\n                    alert('failed to save the video in server')\n                }\n            })\n    }\n    \n    return (\n        <Container maxWidth=\"sm\">\n        <div style={{ maxWidth: '700px', margin: '2rem auto' }}>\n        <div style={{ textAlign: 'center', marginBottom: '2rem' }}>\n            <Typography style={{ fontSize: '50px' }} level={2} > Upload Video</Typography>\n        </div>\n        <hr />\n        <br />\n        <br />\n        <Form className={useStyles().root} onSubmit={onSubmit}>\n            <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n            <Dropzone\n                            onDrop={onDrop}\n                                multiple={false}\n                                maxSize={800000000}>\n                                {({ getRootProps, getInputProps }) => (\n                                    <div style={{ width: '300px', height: '240px', border: '1px solid lightgray', display: 'flex', alignItems: 'center', justifyContent: 'center' }}\n                                        {...getRootProps()}\n                                    >\n                                        <input {...getInputProps()} />\n                                        <Icon type=\"plus\" style={{ fontSize: '3rem' }} />\n\n                                    </div>\n                                )}\n                            </Dropzone>\n                <Grid container spacing={3}>\n                    <Grid item >\n                        <Paper className={useStyles().paper}>\n                        \n                        </Paper>\n                    </Grid>\n                    {Thumbnail !== \"\" &&\n                                <div>\n                                    <img src={`http://localhost:5000/${Thumbnail}`} alt=\"haha\" />\n                                </div>\n                            }\n                </Grid>\n                \n            </div>\n\n            <br /><br />\n            <TextField\n                \n                label=\"Title\"\n                onChange={handleChangeTitle}\n                value={title}\n                variant=\"outlined\"\n                style={{ width: '40rem' }}\n            />\n            <br /><br />\n            <TextField\n                multiline\n                label=\"Description\"\n                onChange={handleChangeDecsription}\n                value={Description}\n                variant=\"outlined\"\n                style={{ width: '40rem'}}\n            />\n            <br /><br />\n\n            <Grid container spacing={10}>\n                <Grid item xs={6} sm={3}>\n\n                <FormControl className={useStyles().formControl}>\n                    <InputLabel >Privacy</InputLabel>\n                    <Select style={{ width: '10rem' }}\n                    value={Private.values[0]}\n                    onChange={handleChangeOne}\n                    >\n                    {Private.map((item, index) => (\n                                <option key={index} value={item.value}>{item.label}</option>\n                            ))}\n                    </Select>\n                    </FormControl>\n                </Grid>\n\n                <Grid item xs={6} sm={3}>\n\n                <FormControl className={useStyles().formControl} style={{ marginLeft: '1rem' }}>\n                    <InputLabel>Categories</InputLabel>\n                    <Select style={{ width: '10rem' }}\n                    value={Private.values[0]}\n                    onChange={handleChangeTwo}\n                    >\n                    {Category.map((item, index) => (\n                                <option key={index} value={item.label}>{item.label}</option>\n                            ))}\n                    </Select>\n                    </FormControl>\n\n                </Grid>\n\n                <Grid item xs={6} sm={3} style={{ marginLeft: '2rem' }}>\n                        <Button\n                        variant=\"contained\"\n                        color=\"default\"\n                        startIcon={<CloudUpload />}\n                        onClick={onSubmit}\n                    >\n                        Upload\n                    </Button>\n                </Grid>\n            </Grid>\n   \n\n        </Form>\n    </div>\n    </Container>\n    )\n}\n\nexport default UploadVideoPage"]},"metadata":{},"sourceType":"module"}